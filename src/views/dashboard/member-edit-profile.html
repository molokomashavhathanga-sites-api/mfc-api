<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Member Portal</title>

    <!-- links -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="../assets/dashboard/css/stylesdash.css" />
    <script src="https://kit.fontawesome.com/e6d1f98a15.js" crossorigin="anonymous"></script>

</head>
<body>
  <div class="app-shell">

  <!-- Sidebar -->
  <aside class="sidebar glass-card">
    <div class="d-flex align-items-center gap-3 mb-4">
      <div class="logo-circle">M</div>
      <div>
        <div class="text-white fw-semibold">MMS</div>
        <div class="small-note">Member Portal</div>
      </div>
    </div>

    <nav class="d-grid gap-2">
      <a class="nav-pill  text-decoration-none" href="/member/portal">
        <span><i class="fas fa-home"></i></span> <span>Overview</span>
      </a>
      <a class="nav-pill text-decoration-none" href="/member/activities">
        <span><i class="fa-solid fa-dumbbell"></i></span> <span>Activities</span>
      </a>
      <a class="nav-pill text-decoration-none" href="/member/nutrition">
        <span><i class="fa-solid fa-apple-whole"></i></span> <span>Nutrition</span>
      </a>
      <a class="nav-pill text-decoration-none" href="/member/personal-details">
        <span><i class="fa-solid fa-id-card"></i></span> <span>Personal Details</span>
      </a>
      <a class="nav-pill active text-decoration-none" href="/member/edit-profile">
        <span><i class="fa-solid fa-user-gear"></i></span> <span>Edit Profile</span>
      </a>
      <a class="nav-pill text-decoration-none" href="/member/billing">
        <span><i class="fa-solid fa-credit-card"></i></span> <span>Membership & Billing</span>
      </a>
      <a class="nav-pill text-decoration-none" href="/member/reports">
        <span><i class="fa-solid fa-chart-area"></i></span> <span>Reports</span>
      </a>
    </nav>

    <div class="mt-4 p-3 rounded-4 glass-card">
      <div class="fw-semibold mb-1 text-white">Quick Tip</div>
      <div class="small-note">
        Small progress daily beats “I’ll start Monday” every time.
      </div>
    </div>

    <div class="mt-4 small-note">
      Logged in as <span class="text-white" id="memberName">Member</span>
    </div>
  </aside>

  <!-- Backdrop for mobile -->
  <div class="backdrop" id="backdrop"></div>

  <!-- /member/edit-profile -->
<main class="content">
  <!-- Topbar -->
  <div class="d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-3 mb-4">
    <div>
      <div class="d-flex align-items-center gap-2 mb-2">
        <button class="btn btn-outline-light sidebar-toggle" id="toggleSidebar" type="button">
          <i class="fa-solid fa-bars"></i> Menu
        </button>
      </div>

      <h1 class="h3 text-white mb-1">Edit Profile</h1>
      <div class="muted">Update your account details and security settings.</div>
    </div>

    <div class="d-flex gap-2 flex-wrap">
      <button class="btn btn-outline-light" type="button" id="cancelProfileBtn">
        Cancel
      </button>
      <button class="btn btn-primary" type="button" id="saveProfileBtn">
        Save Changes
      </button>
    </div>
  </div>

  <div class="row g-3">
    <!-- Profile Card -->
    <div class="col-lg-4">
      <section class="card glass-card rounded-4 shadow-sm">
        <div class="card-body p-4">
          <h2 class="h5 text-white mb-1">Profile</h2>
          <div class="small-note mb-3">Your public-facing member info.</div>

          <div class="d-flex flex-column align-items-center text-center">
            <img
              src="/img/default-avatar.png"
              alt="Profile"
              class="rounded-circle border"
              style="width: 110px; height: 110px; object-fit: cover; border-color: rgba(255,255,255,.18) !important;"
              id="profilePreview"
            />

            <div class="mt-3 w-100">
              <label class="form-label small-note">Profile Picture</label>
              <input class="form-control" type="file" accept="image/*" id="profileImage" />
              <div class="small-note mt-2">JPG/PNG recommended. Keep it clean.</div>
            </div>

            <div class="mt-3 w-100">
              <label class="form-label small-note">Display Name</label>
              <input class="form-control" id="displayName" placeholder="e.g. Sbu Msimango" />
            </div>

            <div class="mt-3 w-100">
              <label class="form-label small-note">Member Bio (optional)</label>
              <textarea class="form-control" rows="3" id="bio" placeholder="e.g. Goals, focus, training style..."></textarea>
            </div>
          </div>
        </div>
      </section>
    </div>

    <!-- Account Details -->
    <div class="col-lg-8">
      <section class="card glass-card rounded-4 shadow-sm mb-3">
        <div class="card-body p-4">
          <h2 class="h5 text-white mb-1">Account Details</h2>
          <div class="small-note mb-3">These details are used for login and communication.</div>

          <div class="row g-3">
            <div class="col-md-6">
              <label class="form-label small-note">First Name</label>
              <input class="form-control" id="firstName" placeholder="First name" />
            </div>

            <div class="col-md-6">
              <label class="form-label small-note">Last Name</label>
              <input class="form-control" id="lastName" placeholder="Last name" />
            </div>

            <div class="col-md-6">
              <label class="form-label small-note">Email</label>
              <input class="form-control" id="email" type="email" placeholder="you@email.com" />
            </div>

            <div class="col-md-6">
              <label class="form-label small-note">Phone (optional)</label>
              <input class="form-control" id="phone" placeholder="+27 ..." />
            </div>

            <div class="col-12">
              <label class="form-label small-note">Notification Preferences</label>
              <div class="row g-2 mt-1">
                <div class="col-sm-4">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="notifyEmail" checked>
                    <label class="form-check-label" for="notifyEmail">Email</label>
                  </div>
                </div>
                <div class="col-sm-4">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="notifySms">
                    <label class="form-check-label" for="notifySms">SMS</label>
                  </div>
                </div>
                <div class="col-sm-4">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="notifyWhatsapp">
                    <label class="form-check-label" for="notifyWhatsapp">WhatsApp</label>
                  </div>
                </div>
              </div>

              <div class="small-note mt-2">You can switch this anytime. No spam. Promise.</div>
            </div>
          </div>
        </div>
      </section>

      <!-- Security -->
      <section class="card glass-card rounded-4 shadow-sm">
        <div class="card-body p-4">
          <div class="d-flex align-items-center justify-content-between mb-2">
            <div>
              <h2 class="h5 text-white mb-1">Security</h2>
              <div class="small-note">Change your password safely.</div>
            </div>
            <button class="btn btn-outline-light btn-sm" type="button" id="logoutAllBtn">
              Log out all devices
            </button>
          </div>

          <div class="row g-3 mt-1">
            <div class="col-md-4">
              <label class="form-label small-note">Current Password</label>
              <div class="input-group">
                <input class="form-control" type="password" id="currentPassword" placeholder="••••••••">
                <button class="btn btn-outline-light" type="button" data-toggle-pass="currentPassword">
                  <i class="fa-solid fa-eye"></i>
                </button>
              </div>
            </div>

            <div class="col-md-4">
              <label class="form-label small-note">New Password</label>
              <div class="input-group">
                <input class="form-control" type="password" id="newPassword" placeholder="New password">
                <button class="btn btn-outline-light" type="button" data-toggle-pass="newPassword">
                  <i class="fa-solid fa-eye"></i>
                </button>
              </div>
              <div class="small-note mt-2">Use 8+ characters. Mix it up.</div>
            </div>

            <div class="col-md-4">
              <label class="form-label small-note">Confirm New Password</label>
              <div class="input-group">
                <input class="form-control" type="password" id="confirmPassword" placeholder="Confirm">
                <button class="btn btn-outline-light" type="button" data-toggle-pass="confirmPassword">
                  <i class="fa-solid fa-eye"></i>
                </button>
              </div>
            </div>

            <div class="col-12 mt-2">
              <div class="p-3 rounded-4 glass-card">
                <div class="text-white fw-semibold mb-1">Security Note</div>
                <div class="small-note">
                  If you didn’t request a password change, don’t touch these fields. Easy.
                </div>
              </div>
            </div>

            <div class="col-12 d-flex gap-2 flex-wrap mt-2">
              <button class="btn btn-outline-light" type="button" id="clearPasswordFieldsBtn">Clear</button>
              <button class="btn btn-primary" type="button" id="updatePasswordBtn">Update Password</button>
            </div>
          </div>
        </div>
      </section>
    </div>
  </div>
</main>

<script>
  // Preview profile image
  document.getElementById("profileImage")?.addEventListener("change", (e) => {
    const file = e.target.files?.[0];
    if (!file) return;
    const url = URL.createObjectURL(file);
    document.getElementById("profilePreview").src = url;
  });

  // Toggle password visibility buttons
  document.querySelectorAll("[data-toggle-pass]")?.forEach(btn => {
    btn.addEventListener("click", () => {
      const id = btn.getAttribute("data-toggle-pass");
      const input = document.getElementById(id);
      if (!input) return;
      input.type = input.type === "password" ? "text" : "password";
    });
  });

  // Save profile (hook to API later)
  document.getElementById("saveProfileBtn")?.addEventListener("click", () => {
    alert("Profile saved (hook API next).");
  });

  document.getElementById("cancelProfileBtn")?.addEventListener("click", () => {
    history.back();
  });

  // Password actions
  document.getElementById("clearPasswordFieldsBtn")?.addEventListener("click", () => {
    ["currentPassword","newPassword","confirmPassword"].forEach(id => {
      const el = document.getElementById(id);
      if (el) el.value = "";
    });
  });

  document.getElementById("updatePasswordBtn")?.addEventListener("click", () => {
    const current = document.getElementById("currentPassword").value.trim();
    const next = document.getElementById("newPassword").value.trim();
    const confirm = document.getElementById("confirmPassword").value.trim();

    if (!current || !next || !confirm) {
      alert("Please fill in all password fields.");
      return;
    }
    if (next.length < 8) {
      alert("New password must be at least 8 characters.");
      return;
    }
    if (next !== confirm) {
      alert("New password and confirm password do not match.");
      return;
    }

    // TODO: API call to update password
    alert("Password updated (hook API next).");
  });

  document.getElementById("logoutAllBtn")?.addEventListener("click", () => {
    // TODO: backend endpoint to revoke tokens/sessions
    alert("All devices logged out (hook API next).");
  });
</script>


  </div>
  </body>
  </html>
